{
  "Description": "Drata IAM Role to set read permissions in Org Member Accounts",
  "Parameters": {
      "RolePrincipalAWS": {
          "Type": "String",
          "Description": "Management Account ARN for this Organization",
          "Default": "arn:aws:iam::012345678912:root",
          "AllowedPattern": "^arn:aws:iam::\\d{12}:root$",
          "ConstraintDescription": "RolePrincipalAWS must match arn:aws:iam::{ID}:root where ID is a numeric string with length of 12"
      },
      "RoleSTSExternalID": {
          "Type": "String",
          "Description": "STS ExternalId condition value to use with the role",
          "Default": "00000000-0000-0000-0000-000000000000",
          "AllowedPattern": "[a-zA-Z0-9\\=\\,\\.\\@\\:\\/\\-_]*",
          "ConstraintDescription": "STS ExternalId condition value to use with the role must contain alphanumeric characters and only these special characters are allowed =,.@:/-. "
      }
  },
  "Resources": {
      "DrataRole": {
          "Type": "AWS::IAM::Role",
          "Properties": {
              "ManagedPolicyArns": ["arn:aws:iam::aws:policy/SecurityAudit"],
              "MaxSessionDuration": 43200,
              "AssumeRolePolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [
                      {
                          "Effect": "Allow",
                          "Principal": {
                              "AWS": [{ "Ref": "RolePrincipalAWS" }]
                          },
                          "Action": "sts:AssumeRole",
                          "Condition": {
                              "StringEquals": {
                                  "sts:ExternalId": {
                                      "Ref": "RoleSTSExternalID"
                                  }
                              }
                          }
                      }
                  ]
              },
              "RoleName": "DrataAutopilotRole",
              "Description": "Cross-account read-only access for Drata Autopilot"
          }
      }
  }
}