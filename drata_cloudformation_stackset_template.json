{
  "Description": "Drata IAM Role to set read permissions in Org Member Accounts",
  "Parameters": {
      "DrataAWSAccountARN": {
          "Type": "String",
          "Description": "Drata's AWS account ARN.",
          "Default":"arn:aws:iam::269135526815:root",
          "AllowedPattern": "arn:aws:iam::\\d{12}:root$",
          "MinLength": 1,
          "ConstraintDescription": "DrataAWSAccountARN follows the format 'arn:aws:iam::' followed by exactly 12 digits (numeric characters) and ending with ':root'. It's required."
      },
      "RoleSTSExternalID": {
          "Type": "String",
          "Description": "STS ExternalId condition value to use with the role.",
          "AllowedPattern": "[a-zA-Z0-9\\=\\,\\.\\@\\:\\/\\-_]*",
          "MinLength": 1,
          "ConstraintDescription": "RoleSTSExternalID must be an UUID formatted string and is required."
      }
  },
  "Resources": {
      "DrataRole": {
          "Type": "AWS::IAM::Role",
          "Properties": {
              "ManagedPolicyArns": ["arn:aws:iam::aws:policy/SecurityAudit"],
              "MaxSessionDuration": 43200,
              "AssumeRolePolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [
                      {
                          "Effect": "Allow",
                          "Principal": {
                              "AWS": [{ "Ref": "DrataAWSAccountARN" }]
                          },
                          "Action": "sts:AssumeRole",
                          "Condition": {
                              "StringEquals": {
                                  "sts:ExternalId": {
                                      "Ref": "RoleSTSExternalID"
                                  }
                              }
                          }
                      }
                  ]
              },
              "RoleName": "DrataAutopilotRole",
              "Description": "Cross-account read-only access for Drata Autopilot"
          }
      }
  }
}